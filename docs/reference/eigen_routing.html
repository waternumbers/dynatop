<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Routing by eigen value method — eigen_routing • dynatop</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Routing by eigen value method — eigen_routing" />

<meta property="og:description" content="Functions to setup and then evaluate the eigen vector method of Dummit, 2016
The following notes are taken verbatim from the original implimentation of Peter. They do not appear to match the equations and may be irrelevent but added for completeness...
 ## Qin = exS 
 ## Linear storage-discharge relationship
 ## Qout = a * vof * ex
 ## dExS/dt = Qin - Qbf
 ##        = Wv 
 ## ExS is total surface excess storage
 ## where Wv = complementary overland routing matrix
## Solution for surface routing by Eigenvalue method (see Dummit, 2016; )
 ## general soln at time t is
 ## sigma(exp(lambda_i * t*)ci * ui)
 ## where ui are eigenvectors, li eigenvalues and ci constants TBD by
 ## boundary conditions" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynatop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Performance_Evaluation.html">Code Performance for larger simulations</a>
    </li>
    <li>
      <a href="../articles/The_solution_of_Dynamic_TOPMODEL.html">The Numerical Solution of Dynamic TOPMODEL</a>
    </li>
    <li>
      <a href="../articles/model_object.html">The Model Object</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/waternumbers/dynatop">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Routing by eigen value method</h1>
    <small class="dont-index">Source: <a href='https://github.com/waternumbers/dynatop/blob/master/R/eigen_routing.R'><code>R/eigen_routing.R</code></a></small>
    <div class="hidden name"><code>eigen_routing.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Functions to setup and then evaluate the eigen vector method of Dummit, 2016</p>
<p>The following notes are taken verbatim from the original implimentation of Peter. They do not appear to match the equations and may be irrelevent but added for completeness...
 ## Qin = exS <!-- %*% Wsurf -->
 ## Linear storage-discharge relationship
 ## Qout = a * vof * ex
 ## dExS/dt = Qin - Qbf
 ##        = Wv <!-- %*% exS -->
 ## ExS is total surface excess storage
 ## where Wv = complementary overland routing matrix</p>
<p>## Solution for surface routing by Eigenvalue method (see Dummit, 2016; )
 ## general soln at time t is
 ## sigma(exp(lambda_i * t*)ci * ui)
 ## where ui are eigenvectors, li eigenvalues and ci constants TBD by
 ## boundary conditions</p>
    
    </div>

    <pre class="usage"><span class='fu'>eigen_routing_setup</span>(<span class='no'>K</span>)

<span class='fu'>eigen_routing_step</span>(<span class='no'>v</span>, <span class='no'>eig</span>, <span class='no'>dt</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>v</th>
      <td><p>vector of volumes to be redistributed</p></td>
    </tr>
    <tr>
      <th>eig</th>
      <td><p>an object containing summaries of eigen matrix and vectors</p></td>
    </tr>
    <tr>
      <th>dt</th>
      <td><p>time step to be taken</p></td>
    </tr>
    <tr>
      <th>W</th>
      <td><p>matrix of weights for distribution</p></td>
    </tr>
    <tr>
      <th>vof</th>
      <td><p>UNKNOWN</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Either an eig object (eigen_setup) or a revised set of volumes after time step</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Peter Metcalfe, Paul Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

