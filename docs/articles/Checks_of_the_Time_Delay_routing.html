<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checks of the Time Delay Routing â€¢ dynatop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Checks of the Time Delay Routing">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynatop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dynatop.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Banding.html">Banding of HSUs</a>
    </li>
    <li>
      <a href="../articles/Checks_of_the_Hillslope_HRU.html">Checks of the Hillslope HRU</a>
    </li>
    <li>
      <a href="../articles/Checks_of_the_Time_Delay_routing.html">Checks of the Time Delay Routing</a>
    </li>
    <li>
      <a href="../articles/Selected_References.html">Selected References</a>
    </li>
    <li>
      <a href="../articles/The_Model_Object.html">The Model Object</a>
    </li>
    <li>
      <a href="../articles/The_solution_of_Dynamic_TOPMODEL.html">The Dynamic TOPMODEL Implimentation</a>
    </li>
    <li>
      <a href="../articles/Time_Delay_Channel_Routing.html">Time Delay Channel Routing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waternumbers/dynatop">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Checks of the Time Delay Routing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waternumbers/dynatop/blob/master/../vignettes/Checks_of_the_Time_Delay_routing.Rmd"><code>../vignettes/Checks_of_the_Time_Delay_routing.Rmd</code></a></small>
      <div class="hidden name"><code>Checks_of_the_Time_Delay_routing.Rmd</code></div>

    </div>

    
    
<p>The purpose of this vignette is to demonstrate somesimulation checks on the computation of time delay routing. It provides both a check for the current implimentation of the code and a demonstration for those that may be developing more complex systems and want to perform their own test.</p>
<p>The basis of the simulations used in the test catchment contained within the package which is loaded with</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">##rm(list=ls())</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dynatop)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; Loading required package: xts</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; Loading required package: zoo</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; Attaching package: 'zoo'</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;     as.Date, as.Date.numeric</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; Registered S3 method overwritten by 'xts':</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;   method     from</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt;   as.zoo.xts zoo</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"test_catchments"</span>)</a></code></pre></div>
<div id="an-initial-inflow-series" class="section level1">
<h1 class="hasAnchor">
<a href="#an-initial-inflow-series" class="anchor"></a>An initial inflow series</h1>
<p>Generate an initial inflow series of computed by simulating the test catchment</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">sim_inflows &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dynatop.html">dynatop</a></span>(test_catchments<span class="op">$</span>simple_hillslope,test_catchments<span class="op">$</span>obs,<span class="fl">0.0015</span>)<span class="op">$</span>channel_input</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(sim_inflows,<span class="dt">title=</span><span class="st">"Basic inflows set"</span>)</a></code></pre></div>
<p><img src="Checks_of_the_Time_Delay_routing_files/figure-html/initialise_state_func-1.png" width="700"></p>
</div>
<div id="check-the-time-delays" class="section level1">
<h1 class="hasAnchor">
<a href="#check-the-time-delays" class="anchor"></a>Check the time delays</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(test_catchments<span class="op">$</span>simple_hillslope)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; outlet          0     400</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; mid_point      NA     325</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;             1   2</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; outlet    150 650</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; mid_point  75 575</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;   1   2 </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; 150 500</span></a></code></pre></div>
</div>
<div id="check-the-mass-conservation" class="section level1">
<h1 class="hasAnchor">
<a href="#check-the-mass-conservation" class="anchor"></a>Check the mass conservation</h1>
<p>These simulations aim to check the mass conservation of the model.</p>
<div id="channel-inflows" class="section level2">
<h2 class="hasAnchor">
<a href="#channel-inflows" class="anchor"></a>Channel inflows</h2>
<p>Firstly we do the channel inflows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">## make empty point inflows</span></a>
<a class="sourceLine" id="cb4-2" title="2">pf &lt;-<span class="st"> </span>sim_inflows; pf[] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(pf) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"point_1"</span>,<span class="st">"point_2"</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">## High velocity - everything comes out at once...</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">## set the velocity very high so it all comes out in one time step</span></a>
<a class="sourceLine" id="cb4-7" title="7">mdl &lt;-<span class="st"> </span>test_catchments<span class="op">$</span>simple_hillslope</a>
<a class="sourceLine" id="cb4-8" title="8">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; outlet          0   0.400</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; mid_point      NA   0.325</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt;               1     2</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt; outlet    0.150 0.650</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; mid_point 0.075 0.575</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt; 0.15 0.50</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb4-24" title="24">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,sim_inflows,</a>
<a class="sourceLine" id="cb4-25" title="25">                          <span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">## mass balance as percentage</span></a>
<a class="sourceLine" id="cb4-27" title="27">(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(out[,<span class="st">'outlet'</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows))<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows)</a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt; [1] -1.446273e-14</span></a>
<a class="sourceLine" id="cb4-29" title="29"></a>
<a class="sourceLine" id="cb4-30" title="30"></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">## break it down over a couple of time steps</span></a>
<a class="sourceLine" id="cb4-32" title="32">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">#&gt; outlet          0     800</span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#&gt; mid_point      NA     650</span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt;             1    2</span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt; outlet    300 1300</span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co">#&gt; mid_point 150 1150</span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">#&gt;  300 1000</span></a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co">## nned to provide zero flow initial conditions</span></a>
<a class="sourceLine" id="cb4-48" title="48">ic &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">channel_inflows=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>=<span class="dv">0</span>,<span class="st">"2"</span>=<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb4-49" title="49"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb4-50" title="50">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,sim_inflows,</a>
<a class="sourceLine" id="cb4-51" title="51">                          <span class="dt">point_inflows=</span>pf,</a>
<a class="sourceLine" id="cb4-52" title="52">                          <span class="dt">initial_conditions=</span>ic)</a>
<a class="sourceLine" id="cb4-53" title="53"><span class="co">## mass balance as percentage</span></a>
<a class="sourceLine" id="cb4-54" title="54">(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(out[,<span class="st">'outlet'</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows))<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows)</a>
<a class="sourceLine" id="cb4-55" title="55"><span class="co">#&gt; [1] -1.446273e-14</span></a></code></pre></div>
</div>
<div id="diffuse-inflows" class="section level2">
<h2 class="hasAnchor">
<a href="#diffuse-inflows" class="anchor"></a>Diffuse inflows</h2>
<p>The diffuse inflow should return exactly the same results</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">## make empty channel and point inflows</span></a>
<a class="sourceLine" id="cb5-2" title="2">cf &lt;-<span class="st"> </span>sim_inflows; cf[] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb5-3" title="3">pf &lt;-<span class="st"> </span>cf; <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(pf) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"point_1"</span>,<span class="st">"point_2"</span>)</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">## High velocity - everything comes out at once...</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">## set the velocity very high so it all comes out in one time step</span></a>
<a class="sourceLine" id="cb5-7" title="7">mdl &lt;-<span class="st"> </span>test_catchments<span class="op">$</span>simple_hillslope</a>
<a class="sourceLine" id="cb5-8" title="8">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; outlet          0   0.400</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; mid_point      NA   0.325</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt;               1     2</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; outlet    0.150 0.650</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; mid_point 0.075 0.575</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; 0.15 0.50</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb5-24" title="24">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf,</a>
<a class="sourceLine" id="cb5-25" title="25">                          <span class="dt">diffuse_inflows =</span> sim_inflows,</a>
<a class="sourceLine" id="cb5-26" title="26">                          <span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">## mass balance as percentage</span></a>
<a class="sourceLine" id="cb5-28" title="28">(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(out[,<span class="st">'outlet'</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows))<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows)</a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt; [1] -1.446273e-14</span></a>
<a class="sourceLine" id="cb5-30" title="30"></a>
<a class="sourceLine" id="cb5-31" title="31"></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">## break it down over a couple of time steps</span></a>
<a class="sourceLine" id="cb5-33" title="33">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="co">#&gt; outlet          0     800</span></a>
<a class="sourceLine" id="cb5-38" title="38"><span class="co">#&gt; mid_point      NA     650</span></a>
<a class="sourceLine" id="cb5-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="co">#&gt;             1    2</span></a>
<a class="sourceLine" id="cb5-42" title="42"><span class="co">#&gt; outlet    300 1300</span></a>
<a class="sourceLine" id="cb5-43" title="43"><span class="co">#&gt; mid_point 150 1150</span></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-45" title="45"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb5-46" title="46"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb5-47" title="47"><span class="co">#&gt;  300 1000</span></a>
<a class="sourceLine" id="cb5-48" title="48"><span class="co">## nned to provide zero flow initial conditions</span></a>
<a class="sourceLine" id="cb5-49" title="49">ic &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">channel_inflows=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>=<span class="dv">0</span>,<span class="st">"2"</span>=<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb5-50" title="50"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb5-51" title="51">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf,</a>
<a class="sourceLine" id="cb5-52" title="52">                          <span class="dt">diffuse_inflows =</span> sim_inflows,</a>
<a class="sourceLine" id="cb5-53" title="53">                          <span class="dt">point_inflows=</span>pf,</a>
<a class="sourceLine" id="cb5-54" title="54">                          <span class="dt">initial_conditions=</span>ic)</a>
<a class="sourceLine" id="cb5-55" title="55"><span class="co">## mass balance as percentage</span></a>
<a class="sourceLine" id="cb5-56" title="56">(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(out[,<span class="st">'outlet'</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows))<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows)</a>
<a class="sourceLine" id="cb5-57" title="57"><span class="co">#&gt; [1] -1.446273e-14</span></a></code></pre></div>
</div>
<div id="point-inflow" class="section level2">
<h2 class="hasAnchor">
<a href="#point-inflow" class="anchor"></a>Point inflow</h2>
<p>The point inflow tests:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">## make empty channel and point inflows</span></a>
<a class="sourceLine" id="cb6-2" title="2">pf &lt;-<span class="st"> </span>sim_inflows;</a>
<a class="sourceLine" id="cb6-3" title="3">cf &lt;-<span class="st"> </span>pf; cf[] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(pf) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"point_1"</span>,<span class="st">"point_2"</span>)</a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">## High velocity - everything comes out at once...</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">## set the velocity very high so it all comes out in one time step</span></a>
<a class="sourceLine" id="cb6-8" title="8">mdl &lt;-<span class="st"> </span>test_catchments<span class="op">$</span>simple_hillslope</a>
<a class="sourceLine" id="cb6-9" title="9">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; outlet          0   0.400</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; mid_point      NA   0.325</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt;               1     2</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; outlet    0.150 0.650</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; mid_point 0.075 0.575</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; 0.15 0.50</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb6-25" title="25">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf,</a>
<a class="sourceLine" id="cb6-26" title="26">                          <span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">## mass balance as percentage</span></a>
<a class="sourceLine" id="cb6-28" title="28">(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(out[,<span class="st">'outlet'</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows))<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(sim_inflows)</a>
<a class="sourceLine" id="cb6-29" title="29"><span class="co">#&gt; [1] -1.446273e-14</span></a>
<a class="sourceLine" id="cb6-30" title="30"></a>
<a class="sourceLine" id="cb6-31" title="31"></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">## break it down over a couple of time steps</span></a>
<a class="sourceLine" id="cb6-33" title="33">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) </a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#&gt; outlet          0    8000</span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#&gt; mid_point      NA    6500</span></a>
<a class="sourceLine" id="cb6-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb6-41" title="41"><span class="co">#&gt;              1     2</span></a>
<a class="sourceLine" id="cb6-42" title="42"><span class="co">#&gt; outlet    3000 13000</span></a>
<a class="sourceLine" id="cb6-43" title="43"><span class="co">#&gt; mid_point 1500 11500</span></a>
<a class="sourceLine" id="cb6-44" title="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-45" title="45"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb6-46" title="46"><span class="co">#&gt;     1     2 </span></a>
<a class="sourceLine" id="cb6-47" title="47"><span class="co">#&gt;  3000 10000</span></a>
<a class="sourceLine" id="cb6-48" title="48"><span class="co">## need to provide zero flow initial conditions</span></a>
<a class="sourceLine" id="cb6-49" title="49">ic &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">channel_inflows=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>=<span class="dv">0</span>,<span class="st">"2"</span>=<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb6-50" title="50"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb6-51" title="51">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf,</a>
<a class="sourceLine" id="cb6-52" title="52">                          <span class="dt">point_inflows=</span>pf,</a>
<a class="sourceLine" id="cb6-53" title="53">                          <span class="dt">initial_conditions=</span>ic)</a>
<a class="sourceLine" id="cb6-54" title="54"><span class="co">## mass balance as percentage</span></a>
<a class="sourceLine" id="cb6-55" title="55">(<span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(out[,<span class="st">'outlet'</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(pf))<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(pf)</a>
<a class="sourceLine" id="cb6-56" title="56"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
</div>
</div>
<div id="checking-a-single-channel" class="section level1">
<h1 class="hasAnchor">
<a href="#checking-a-single-channel" class="anchor"></a>Checking a single channel</h1>
<p>The lower of the test catchment channels has two gauges, one at the foot and one half way down. Providing inflow only to the lower channel should result in half the flow being observed at the mid point gauge.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">## make empty point inflows</span></a>
<a class="sourceLine" id="cb7-2" title="2">cf &lt;-<span class="st"> </span>sim_inflows</a>
<a class="sourceLine" id="cb7-3" title="3">cf[,<span class="st">"2"</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># set flow to upper channel to zero</span></a>
<a class="sourceLine" id="cb7-4" title="4">pf &lt;-<span class="st"> </span>sim_inflows; pf[] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(pf) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"point_1"</span>,<span class="st">"point_2"</span>)</a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">## High velocity - everything comes out at once...</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">## set the velocity very high so it all comes out in one time step</span></a>
<a class="sourceLine" id="cb7-9" title="9">mdl &lt;-<span class="st"> </span>test_catchments<span class="op">$</span>simple_hillslope</a>
<a class="sourceLine" id="cb7-10" title="10">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; outlet          0   0.400</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; mid_point      NA   0.325</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt;               1     2</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; outlet    0.150 0.650</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; mid_point 0.075 0.575</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt; 0.15 0.50</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb7-26" title="26">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf,</a>
<a class="sourceLine" id="cb7-27" title="27">                          <span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">## plot ratio</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(out[,<span class="st">'outlet'</span>]<span class="op">/</span>out[,<span class="st">'mid_point'</span>])</a>
<a class="sourceLine" id="cb7-30" title="30"></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">## break it down over a couple of time steps</span></a>
<a class="sourceLine" id="cb7-32" title="32">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="kw"><a href="../reference/compute_time_delay.html">compute_time_delay</a></span>(mdl) <span class="co"># all values less then 1</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt; $point_to_gauge</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt;           point_1 point_2</span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt; outlet          0     800</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt; mid_point      NA     650</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt; $head_to_gauge</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt;             1    2</span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt; outlet    300 1300</span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt; mid_point 150 1150</span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt; $reach_time</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#&gt;  300 1000</span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">## run routing</span></a>
<a class="sourceLine" id="cb7-48" title="48">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf,</a>
<a class="sourceLine" id="cb7-49" title="49">                          <span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">## plot ratio</span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(out[,<span class="st">'outlet'</span>]<span class="op">/</span>out[,<span class="st">'mid_point'</span>])</a></code></pre></div>
<p><img src="Checks_of_the_Time_Delay_routing_files/figure-html/half_channel-1.png" width="700"></p>
</div>
<div id="supersition" class="section level1">
<h1 class="hasAnchor">
<a href="#supersition" class="anchor"></a>Supersition</h1>
<p>We should be able to run the reaches seperately and add the results to get the same output as running both combined.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">## make empty point inflows</span></a>
<a class="sourceLine" id="cb8-2" title="2">pf &lt;-<span class="st"> </span>sim_inflows; pf[] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(pf) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"point_1"</span>,<span class="st">"point_2"</span>)</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">## make two seperate inflows for the two reaches</span></a>
<a class="sourceLine" id="cb8-5" title="5">cf1 &lt;-<span class="st"> </span>sim_inflows; cf1[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb8-6" title="6">cf2 &lt;-<span class="st"> </span>sim_inflows; cf2[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8">mdl<span class="op">$</span>param[<span class="st">"v_ch_default"</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">## simulate</span></a>
<a class="sourceLine" id="cb8-10" title="10">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,sim_inflows,<span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb8-11" title="11">out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf1,<span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb8-12" title="12">out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/time_delay_routing.html">time_delay_routing</a></span>(mdl,cf2,<span class="dt">point_inflows=</span>pf)</a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">tmp &lt;-<span class="st"> </span>out1 <span class="op">+</span><span class="st"> </span>out2</a>
<a class="sourceLine" id="cb8-15" title="15"><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(out<span class="op">-</span>tmp))</a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb8-17" title="17"></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(out1[,<span class="st">'outlet'</span>],out2[,<span class="st">'outlet'</span>]))</a></code></pre></div>
<p><img src="Checks_of_the_Time_Delay_routing_files/figure-html/sup-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#an-initial-inflow-series">An initial inflow series</a></li>
      <li><a href="#check-the-time-delays">Check the time delays</a></li>
      <li>
<a href="#check-the-mass-conservation">Check the mass conservation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#channel-inflows">Channel inflows</a></li>
      <li><a href="#diffuse-inflows">Diffuse inflows</a></li>
      <li><a href="#point-inflow">Point inflow</a></li>
      </ul>
</li>
      <li><a href="#checking-a-single-channel">Checking a single channel</a></li>
      <li><a href="#supersition">Supersition</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul Smith, Peter Metcalfe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
