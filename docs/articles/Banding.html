<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Banding of HSUs â€¢ dynatop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Banding of HSUs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynatop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dynatop.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Banding.html">Banding of HSUs</a>
    </li>
    <li>
      <a href="../articles/Checks_of_the_Hillslope_HRU.html">Checks of the Hillslope HRU</a>
    </li>
    <li>
      <a href="../articles/Checks_of_the_Time_Delay_routing.html">Checks of the Time Delay Routing</a>
    </li>
    <li>
      <a href="../articles/Selected_References.html">Selected References</a>
    </li>
    <li>
      <a href="../articles/The_Model_Object.html">The Model Object</a>
    </li>
    <li>
      <a href="../articles/The_solution_of_Dynamic_TOPMODEL.html">The Dynamic TOPMODEL Implimentation</a>
    </li>
    <li>
      <a href="../articles/Time_Delay_Channel_Routing.html">Time Delay Channel Routing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waternumbers/dynatop">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Banding of HSUs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waternumbers/dynatop/blob/master/../vignettes/Banding.Rmd"><code>../vignettes/Banding.Rmd</code></a></small>
      <div class="hidden name"><code>Banding.Rmd</code></div>

    </div>

    
    
<div id="banding" class="section level1">
<h1 class="hasAnchor">
<a href="#banding" class="anchor"></a>Banding</h1>
<p>This document tries to explain the logic in the process of combining computational bands. The computational bands provide the order needed to solve the saturated zone kinematic wave routing. That is by proceeding through the bands in sequence (low to high) ensures the correct inflows are available for the soltuion of downslope HSUs.</p>
<p>Simplification by merging the computational bands is not possible without altering the connectivity of the hillslope representation. However the banding may increase the lengh of the HSU representations which, ofr a given computational timestep may result in an improved capturing og kinematic effects. The level of banding, resulting simplification and impact on the solutions is best determined by experimentation.</p>
</div>
<div id="banding-implimentation" class="section level1">
<h1 class="hasAnchor">
<a href="#banding-implimentation" class="anchor"></a>Banding Implimentation</h1>
<p>The method of combining the computational bands is as follows</p>
<ol style="list-style-type: decimal">
<li>Split the surface and saturated zone bands into groups using the <code>cut</code> function on both the surface and saturated zone band values</li>
<li>Merge the properties of the HSUs by unique combination of <code>class</code>, surface and saturated zone band groups, using for topographic index and gradient area based weighting. The for botht he durface ans saturated zones the new band is taken to minimium of the respective ofiginal bands within the group.</li>
<li>Using a perterbation matrix <span class="math inline">\(\mathbf{K}\)</span> compute intitial estimates of the surface and saturated zone redistribution matrices <span class="math inline">\(\hat{\mathbf{F}_{*}} = \mathbf{K}^{'}\mathbf{F}_{*}\mathbf{K}\)</span>, for both surface and saturated zones.</li>
<li>Set all values in the <span class="math inline">\(\hat{\mathbf{F}}_{*}\)</span> matrices that imply flow to an earlier or equivilent band to zero.</li>
<li>Merge all HSUs with no flow redistriubtion; that is they do not contribute to a downslope HSU; with the next downslope HSU of the same class. In this case downslope is determined by the saturated zone band. If there is no potential HSU with which to merge issue a warning.</li>
<li>Repeat Steps 4 and 5 until a valid redistribution matrix is acheived.</li>
</ol>
</div>
<div id="a-simple-simulation-experiment" class="section level1">
<h1 class="hasAnchor">
<a href="#a-simple-simulation-experiment" class="anchor"></a>A simple simulation experiment</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(dynatop)</a></code></pre></div>
<pre><code>## Loading required package: dynatop</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: 'zoo'</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Registered S3 method overwritten by 'xts':
##   method     from
##   as.zoo.xts zoo</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(Swindale)</a>
<a class="sourceLine" id="cb9-2" title="2">bmdl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/band_model.html">band_model</a></span>(Swindale<span class="op">$</span>model,<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet

## Warning in band_model(Swindale$model, 5): Unable to merge all new bands without
## outlet</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="../reference/check_model.html">check_model</a></span>(bmdl)</a></code></pre></div>
<pre><code>## [1] "unknown"</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">bmdl<span class="op">$</span>hillslope[,<span class="st">'pet'</span>] &lt;-<span class="st"> </span>bmdl<span class="op">$</span>channel[,<span class="st">'pet'</span>] &lt;-<span class="st"> "PET"</span></a>
<a class="sourceLine" id="cb13-2" title="2">bmdl<span class="op">$</span>hillslope[,<span class="st">'precip'</span>] &lt;-<span class="st"> </span>bmdl<span class="op">$</span>channel[,<span class="st">'precip'</span>] &lt;-<span class="st"> "Rainfall"</span></a>
<a class="sourceLine" id="cb13-3" title="3">btmp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dynatop.html">dynatop</a></span>(bmdl,Swindale<span class="op">$</span>obs,<span class="fl">0.000001</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#banding">Banding</a></li>
      <li><a href="#banding-implimentation">Banding Implimentation</a></li>
      <li><a href="#a-simple-simulation-experiment">A simple simulation experiment</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul Smith, Peter Metcalfe.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
