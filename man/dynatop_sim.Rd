% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dynatop_sim.R
\name{dynatop_sim}
\alias{dynatop_sim}
\title{Run dynamic topmodel}
\usage{
dynatop_sim(
  model,
  obs_data,
  obs_index,
  ts,
  mass_check = FALSE,
  return_states = NULL,
  sz_opt = list(omega = 1, theta = 1)
)
}
\arguments{
\item{model}{A Dynamic TOPMODEL object (see vignette)}

\item{obs_data}{an xts object containing equally spaced time series of observed data.}

\item{mass_check}{return time series of mass balance errors}

\item{return_states}{a vector of POSIXct objects (e.g. from xts) giving the time stamp at which the states should be returned}

\item{sz_opt}{a named list e.g. list(omega=1,theta=1) of parameters controlling the kinematic wave solution for the saturated zone.}

\item{initial_recharge}{Initial recharge to the saturated zone in steady state in m/s}

\item{sim_time_step}{simulation timestep in hours, default value of NULL results in data time step}

\item{use_states}{should the states in the model be used (default FALSE)}
}
\description{
Run dynamic topmodel
}
\details{
use_states, currently does not impose any checks on the state values. return_states fives the states at the end of the timestep. The default values of sz_opt (omega=1,theta=1) ensure there are no negative fluxes. Other values may produce negative values in whiich case theese are set to 0 and a warning issued.
}
